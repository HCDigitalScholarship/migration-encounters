<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Migration Encounters</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="../assets/img/favicon.png" rel="icon">
    <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@600;700&display=swap" rel="stylesheet">
        
    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/animate.css/animate.min.css" rel="stylesheet">
    <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="../assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <link rel="stylesheet" href="../assets/css/shuffle.css">

    <!-- Template Main CSS File -->
    <link href="../assets/css/style.css" rel="stylesheet">
    
    <!-- =======================================================
  * Template Name: Multi - v4.1.0
  * Template URL: https://bootstrapmade.com/multi-responsive-bootstrap-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>
    <main id="main">
        <!-- ======= Header ======= -->
<header id="header" class="fixed-top">
    <div class="container d-flex align-items-center justify-content-between">

      <h1 class="logo"><a href="/">Migration Encounters</a></h1>
      <!-- Uncomment below if you prefer to use an image logo -->
      <!-- <a href="index.html" class="logo"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

      <nav id="navbar" class="navbar">
        <ul>
          <li><a class="nav-link scrollto" href="#about">About</a></li>
          <li><a class="nav-link scrollto" href="#interviews">Interviews</a></li>
          <!-- <li><a class="nav-link scrollto " href="#photographs">Things We Left Behind</a></li> -->
          <li><a class="nav-link scrollto" href="#teaching">Teaching Materials</a></li>

          <li style="margin-left:15px;"><input type="search" class="form-control ds-input" id="search-input" placeholder="Search..." aria-label="Search docs for..." autocomplete="off" data-bd-docs-version="5.0" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top;"></li>
           
        </ul>
        <i class="bi bi-list mobile-nav-toggle"></i>
      </nav><!-- .navbar -->

    </div>
  </header><!-- End Header -->
        

<main id="main">
  <!-- ======= Counts Section ======= -->
  <section id="counts" class="counts" style="margin-top: 120px">
    <div class="container-flex" data-aos="fade-up">
      <div class="row no-gutters">
        <h3 id="result_title">Search Results</h3>

        <div class="col-lg-4 col-md-6 d-md-flex align-items-md-stretch">
          <div
            onclick="set_type('interviews');"
            class="count-box interview_count_box"
          >
            <h4>Interviews</h4>
          </div>
        </div>

        <div class="col-lg-4 col-md-6 d-md-flex align-items-md-stretch">
          <div
            onclick="set_type('quotes');"
            class="count-box annotations_count_box"
          >
            <h4>Quotes</h4>
          </div>
        </div>

        <div class="col-lg-4 col-md-6 d-md-flex align-items-md-stretch">
          <div onclick="set_type('ents');" class="count-box ents_count_box">
            <h4>People, Places and More</h4>
          </div>
        </div>
      </div>

      <div class="row no-gutters" style="margin-top: 30px">
        <div class="col-lg-12 col-md-12 d-md-flex align-items-md-stretch">
          <div class="interviews count-box"></div>
        </div>
      </div>
    </div>
  </section>
  <!-- End Counts Section -->

  <!-- ======= About Section ======= -->
  <section id="about" class="why-us section-bg">
    <div class="container-fluid" data-aos="fade-up">
      <div class="row">
        <div
          class="
            col-lg-12
            d-flex
            flex-column
            justify-content-center
            align-items-stretch
          "
        >
          <div class="content">
            <div class="section-title">
              <h2></h2>
              <p></p>
            </div>

            <p></p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- End About Section -->

  
    </main><!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer">
        <div class="footer-top">
            <div class="container">
                <div class="row">

                    <div class="col-lg-4 col-md-6">
                        <div class="footer-info">
                            <h1>Migration Encounters</h1>
                            <p class="pb-3"><em>Qui repudiandae et eum dolores alias sed ea. Qui suscipit veniam
                                    excepturi quod.</em></p>
                            <p>
                                A108 Adam Street <br>
                                NY 535022, USA<br><br>
                                <strong>Phone:</strong> +1 5589 55488 55<br>
                                <strong>Email:</strong> info@example.com<br>
                            </p>
                            <div class="social-links mt-3">
                                <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                                <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                                <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                                <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                                <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-2 col-md-6 footer-links">
                        <h4>Useful Links</h4>
                        <ul>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Home</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">About us</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Services</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Terms of service</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Privacy policy</a></li>
                        </ul>
                    </div>

                    <div class="col-lg-2 col-md-6 footer-links">
                        <h4>Our Services</h4>
                        <ul>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Web Design</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Web Development</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Product Management</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Marketing</a></li>
                            <li><i class="bx bx-chevron-right"></i> <a href="#">Graphic Design</a></li>
                        </ul>
                    </div>

                    <div class="col-lg-4 col-md-6 footer-newsletter">
                        <h4>Our Newsletter</h4>
                        <p>Tamen quem nulla quae legam multos aute sint culpa legam noster magna</p>
                        <form action="" method="post">
                            <input type="email" name="email"><input type="submit" value="Subscribe">
                        </form>

                    </div>

                </div>
            </div>
        </div>

        
    </footer><!-- End Footer -->

    <div id="preloader"></div>
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="../assets/vendor/aos/aos.js"></script>
    <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="../assets/vendor/php-email-form/validate.js"></script>
    <script src="../assets//vendor/purecounter/purecounter.js"></script>
    <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>

    <!-- Template Main JS File -->
    <script src="../assets//js/main.js"></script>

    <script src="../assets//js/shuffle.js"></script>
    <script>
        // Search bar, on key enter GET search page with query 

        document.querySelector('#search-input').addEventListener('keyup', function() {
          let val = this.value;
          if (event.keyCode === 13) {
              console.log(val)
              window.location.replace(`/search.html?q=${val}&type=interviews`);
          }
      });
      </script>

    

  <!-- search engine  -->
  <script src="https://unpkg.com/lunr/lunr.js"></script>
  <script>
    

    function htmlToElement(html) {
      var template = document.createElement("template");
      html = html.trim(); // Never return a text node of whitespace as the result
      template.innerHTML = html;
      return template.content.firstChild;
    }

    // Access query from the URL
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const query = urlParams.get("q");
    const type = urlParams.get("type");
    function set_type(type){
      window.open(`../search?q=${query}&type=${type}`); 
    };
    
    let interview_results;

    if (query) {
      document.querySelector("#result_title").innerHTML =
      "Search Results for: " + query;

      // Load the inverted index for interviews
      fetch("../assets/lunr/interviews.json")
        .then(function (u) {
          return u.json();
        })
        .then(function (json) {
          const interview_idx = lunr.Index.load(json);
          interview_results = interview_idx.search(query);
          document
            .querySelector(".interview_count_box")
            .appendChild(
              htmlToElement("<h4>" + interview_results.length + "</h4>")
            );
          if (type == "interviews") {
            //set box as active 
            document.querySelector(".interview_count_box").classList.add("active");
            for (i in interview_results) {
              if (interview_results[i].score > 0) {
                document
                  .querySelector(".interviews")
                  .appendChild(
                    htmlToElement(
                      `<div>
                        <a style="border-bottom: 1px solid #010203;
                        border-radius: 0px 0px 0px 8px;" href="../interview/${interview_results[i].ref}">${interview_results[i].ref}</a>
                      </div>`
                    )
                  );
              }
            }
            if (interview_results[i].score == 0) {
              document
                .querySelector(".interviews")
                .appendChild(htmlToElement("<h4>No results</h4>"));
            }
          }

          return interview_results;
        });

      fetch("../assets/lunr/annotations.json")
        .then(function (u) {
          return u.json();
        })
        .then(function (json) {
          
            const annotations_idx = lunr.Index.load(json);
            annotations_results = annotations_idx.search(query);
            document
            .querySelector(".annotations_count_box")
            .appendChild(
              htmlToElement("<h4>" + annotations_results.length + "</h4>")
            );

            if (type == "quotes") {
            document.querySelector(".annotations_count_box").classList.add("active");

            for (i in annotations_results) {
              if (annotations_results[i].score > 0) {
                let url = '../assets/quotes/'+annotations_results[i].ref;
                fetch(url).then((resp) => resp.json())
                .then(function(data) {
                  document
                  .querySelector(".interviews")
                  .appendChild(
                    htmlToElement(
                      `<div style="border-bottom: 1px solid #010203;
                      border-radius: 0px 0px 0px 8px;">
                        <p>${data.text}</p>
                        <a href="../interview/${data.name}">${data.name}</a>

                      </div>`
                    )
                  );
                })
                //fetch quote json
                //text
                // link to interview from name
                // label

                
              } else {
                if (annotations_results[i].score == 0) {
                  document
                    .querySelector(".interviews")
                    .appendChild(htmlToElement("<h4>No results</h4>"));
                }
              }
            }
          }

          
        });

      fetch("../assets/lunr/ents.json")
        .then(function (u) {
          return u.json();
        })
        .then(function (json) {
          const ents_idx = lunr.Index.load(json);
          ents_results = ents_idx.search(query);
          for (i in ents_results) {
            if (ents_results[i].score > 0) {
              //document.querySelector('.quotes').appendChild(htmlToElement('<a href="../interview/'+interview_results[i].ref+ '">'+interview_results[i].ref+'</a>'));
            }
          }
          console.log(ents_results.length);
          document
            .querySelector(".ents_count_box")
            .appendChild(htmlToElement("<h4>" + ents_results.length + "</h4>"));
        });

      if (query && type == "quotes") {
      }
      if (query && type == "ents") {
      }
    } else {
      console.log("no query");
    }

    document
      .querySelector("#search-input")
      .addEventListener("keyup", function () {
        let val = this.value;
        if (event.keyCode === 13) {
          console.log("return");
        }
        if (val.length > 0) {
          let results = idx.search(val);
          console.log(results);
        }
      });
  </script>
  
</body>

</html>